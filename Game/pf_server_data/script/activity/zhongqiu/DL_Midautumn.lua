---------------------------------------------------------------------------------------------
---------------------------------------中秋大陆版--------------------------------------------
---------------------------------------------------------------------------------------------
--刷雕像位置
curS58pos = {1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,
	32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,
	63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79}
S58pos = {}
S58pos[1] = {x = 594, y = 819, z = 872}
S58pos[2] = {x = 488, y = 820, z = 931}
S58pos[3] = {x = 402, y = 822, z = 860}
S58pos[4] = {x = 328, y = 820, z = 824}
S58pos[5] = {x = 504, y = 818, z = 802}
S58pos[6] = {x = 608, y = 820, z = 776}
S58pos[7] = {x = 416, y = 820, z = 752}
S58pos[8] = {x = 316, y = 794, z = 736}
S58pos[9] = {x = 316, y = 819, z = 639}
S58pos[10] = {x = 394, y = 820, z = 670}
S58pos[11] = {x = 623, y = 860, z = 704}
S58pos[12] = {x = 712, y = 820, z = 602}
S58pos[13] = {x = 582, y = 820, z = 606}
S58pos[14] = {x = 460, y = 820, z = 616}
S58pos[15] = {x = 383, y = 895, z = 566}
S58pos[16] = {x = 444, y = 820, z = 498}
S58pos[17] = {x = 528, y = 818, z = 522}
S58pos[18] = {x = 663, y = 820, z = 548}
S58pos[19] = {x = 754, y = 874, z = 529}
S58pos[20] = {x = 614, y = 820, z = 460}
S58pos[21] = {x = 379, y = 820, z = 948}
S58pos[22] = {x = 376, y = 820, z = 1036}
S58pos[23] = {x = 439, y = 820, z = 1093}
S58pos[24] = {x = 444, y = 819, z = 1010}
S58pos[25] = {x = 525, y = 1291, z = 1052}
S58pos[26] = {x = 569, y = 823, z = 988}
S58pos[27] = {x = 619, y = 917, z = 1064}
S58pos[28] = {x = 690, y = 1228, z = 1033}
S58pos[29] = {x = 613, y = 963, z = 977}
S58pos[30] = {x = 672, y = 820, z = 922}
S58pos[31] = {x = 746, y = 820, z = 970}
S58pos[32] = {x = 460, y = 820, z = 697}
S58pos[33] = {x = 648, y = 820, z = 623}
S58pos[34] = {x = 530, y = 820, z = 434}
S58pos[35] = {x = 706, y = 817, z = 456}
S58pos[36] = {x = 825, y = 820, z = 471}
S58pos[37] = {x = 754, y = 820, z = 402}
S58pos[38] = {x = 906, y = 820, z = 426}
S58pos[39] = {x = 837, y = 1193, z = 347}
S58pos[40] = {x = 922, y = 963, z = 342}
S58pos[41] = {x = 864, y = 816, z = 240}
S58pos[42] = {x = 1020, y = 820, z = 379}
S58pos[43] = {x = 950, y = 819, z = 271}
S58pos[44] = {x = 991, y = 826, z = 334}
S58pos[45] = {x = 946, y = 1050, z = 394}
S58pos[46] = {x = 884, y = 867, z = 288}
S58pos[47] = {x = 839, y = 823, z = 414}
S58pos[48] = {x = 774, y = 819, z = 357}
S58pos[49] = {x = 883, y = 818, z = 474}
S58pos[50] = {x = 806, y = 1035, z = 520}
S58pos[51] = {x = 759, y = 818, z = 463}
S58pos[52] = {x = 701, y = 818, z = 393}
S58pos[53] = {x = 623, y = 852, z = 416}
S58pos[54] = {x = 678, y = 818, z = 504}
S58pos[55] = {x = 786, y = 820, z = 595}
S58pos[56] = {x = 604, y = 1028, z = 545}
S58pos[57] = {x = 574, y = 810, z = 394}
S58pos[58] = {x = 493, y = 820, z = 376}
S58pos[59] = {x = 433, y = 819, z = 442}
S58pos[60] = {x = 362, y = 816, z = 485}
S58pos[61] = {x = 469, y = 820, z = 564}
S58pos[62] = {x = 541, y = 820, z = 573}
S58pos[63] = {x = 524, y = 819, z = 650}
S58pos[64] = {x = 386, y = 820, z = 623}
S58pos[65] = {x = 260, y = 820, z = 622}
S58pos[66] = {x = 226, y = 1238, z = 702}
S58pos[67] = {x = 226, y = 820, z = 795}
S58pos[68] = {x = 277, y = 821, z = 787}
S58pos[69] = {x = 492, y = 820, z = 870}
S58pos[70] = {x = 430, y = 820, z = 916}
S58pos[71] = {x = 562, y = 873, z = 932}
S58pos[72] = {x = 659, y = 820, z = 839}
S58pos[73] = {x = 680, y = 848, z = 981}
S58pos[74] = {x = 789, y = 820, z = 926}
S58pos[75] = {x = 866, y = 820, z = 912}
S58pos[76] = {x = 889, y = 820, z = 857}
S58pos[77] = {x = 841, y = 819, z = 812}
S58pos[78] = {x = 783, y = 996, z = 891}
S58pos[79] = {x = 721, y = 820, z = 877}

--传送人
function c5600069_On_Talk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	if TalkIndex == -1 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 444203)				--我知道通往映月塘捷径，确定要我带路吗？
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.AddMsgEvent(MsgID, 21, 4)				--
		msg.AddMsgEvent(MsgID, 1, 100001)			--“确定”
		msg.AddMsgEvent(MsgID, 21, -1)				--
		msg.AddMsgEvent(MsgID, 1, 100002)			--“取消”
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	elseif TalkIndex == 4 then
		if role.GetRoleLevel(MapID, InstanceID, RoleID) < 30 then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444204)  			--等你到了30级，我才能带你过去。
			msg.AddMsgEvent(MsgID, 21, 5)
			msg.AddMsgEvent(MsgID, 1, 100002)		--“取消”
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		else
			role.RoleGotoNewMap(MapID, InstanceID, RoleID, 3373743400, 1074+math.random(5), 6397, 1062+math.random(5))
		end
	end
end
aux.RegisterCreatureEvent(5600069, 7, "c5600069_On_Talk")

--传回人
function c5600070_On_Talk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	if TalkIndex == -1 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 444205)				--确定要回到斗战天城吗？
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.AddMsgEvent(MsgID, 21, 4)				--
		msg.AddMsgEvent(MsgID, 1, 100001)			--“确定”
		msg.AddMsgEvent(MsgID, 21, 5)				--
		msg.AddMsgEvent(MsgID, 1, 100002)			--“取消”
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	elseif TalkIndex == 4 then
		role.RoleGotoNewMap(MapID, InstanceID, RoleID, 3424073512, 610+math.random(5), 23094, 669+math.random(5))
	end
end
aux.RegisterCreatureEvent(5600070, 7, "c5600070_On_Talk")

--御兔童子
function c5600072_On_Talk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	local curhour = tonumber(os.date("%H"))--小时
	local curmin = tonumber(os.date("%M"))--分钟
	if TalkIndex == -1 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 444206)					--映月塘久经月光照耀，
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.AddMsgEvent(MsgID, 21, 4)
		msg.AddMsgEvent(MsgID, 1, 444207)					--“提交宝鉴”
		msg.AddMsgEvent(MsgID, 21, 5)
		msg.AddMsgEvent(MsgID, 1, 444230)					--“查询已提交数量
		msg.AddMsgEvent(MsgID, 21, 6)
		msg.AddMsgEvent(MsgID, 1, 444209)					--“查询排名
		msg.AddMsgEvent(MsgID, 21, 7)
		msg.AddMsgEvent(MsgID, 1, 444208)					--“领取奖励”
		msg.AddMsgEvent(MsgID, 21, 11)
		msg.AddMsgEvent(MsgID, 1, 100002)					--“取消”
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	elseif TalkIndex == 4 then
		if (curhour == 20 or curhour == 21) or (curhour == 22 and curmin < 30) then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444210)				--你打算提交多少个月光宝鉴？
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 8)					--1个
			msg.AddMsgEvent(MsgID, 1, 444211)
			msg.AddMsgEvent(MsgID, 21, 9)					--5个
			msg.AddMsgEvent(MsgID, 1, 444212)
			msg.AddMsgEvent(MsgID, 21, 10)					--10个
			msg.AddMsgEvent(MsgID, 1, 444213)
			msg.AddMsgEvent(MsgID, 21, -1)
			msg.AddMsgEvent(MsgID, 1, 100002)				--“取消”
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444214)				--您已经错过了今天的提交时间。
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)				--“取消”
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	elseif TalkIndex == 5 then
		local CurTime = tonumber(os.date("%j"))
		local UpdateTime = role.GetRoleScriptData(RoleID, 1, RoleDataType["MidAutumnTimes"])
		if CurTime ~= UpdateTime then
			role.SetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"], 0)
			role.SetRoleScriptData(RoleID, 1, RoleDataType["MidAutumnTimes"], CurTime)
		end
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 444231)					--查询个数
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.AddMsgEvent(MsgID, 9, role.GetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"]))
		msg.AddMsgEvent(MsgID, 21, -1)
		msg.AddMsgEvent(MsgID, 1, 100002)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	elseif TalkIndex == 6 then
		if act.GetActScriptData(44, 1, 11) == 0 then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444232)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		elseif act.GetActScriptData(44, 1, 10) == 0 then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444233)
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 11))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 8))
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		elseif act.GetActScriptData(44, 1, 9) == 0 then
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444234)
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 11))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 8))
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 10))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 7))
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444235)
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 11))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 8))
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 10))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 7))
			msg.AddMsgEvent(MsgID, 2, act.GetActScriptData(44, 1, 9))
			msg.AddMsgEvent(MsgID, 9, act.GetActScriptData(44, 1, 6))
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	elseif TalkIndex == 7 then
		if RoleID == act.GetActScriptData(44, 1, 14) then
			if role.GetBagFreeSize(RoleID) < 2 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444216)			--您需要至少两格背包才能领取奖励。
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				role.AddRoleItem(MapID, InstanceID, RoleID, 8112001, 1, 6, 8, 400)
				role.AddRoleItem(MapID, InstanceID, RoleID, 4800166, 1, -1, 8, 400)
				act.SetActScriptData(44, 1, 14, 0)
				act.SaveActScriptData(44)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444217)			--恭喜您摘得桂冠，荣膺魁首！
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		elseif RoleID == act.GetActScriptData(44, 1, 13) then
			if role.GetBagFreeSize(RoleID) < 1 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444218)			--您需要至少一格背包才能领取奖励。
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				role.AddRoleItem(MapID, InstanceID, RoleID, 8112002, 1, 6, 8, 400)
				act.SetActScriptData(44, 1, 13, 0)
				act.SaveActScriptData(44)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444219)			--恭喜您夺得榜眼奖励，再接再厉！
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		elseif RoleID == act.GetActScriptData(44, 1, 12) then
			if role.GetBagFreeSize(RoleID) < 1 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444218)			--您需要至少一格背包才能领取奖励。
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				role.AddRoleItem(MapID, InstanceID, RoleID, 8112003, 1, 6, 8, 400)
				act.SetActScriptData(44, 1, 12, 0)
				act.SaveActScriptData(44)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444223)			--恭喜您获得第三名奖励，继续加油！
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, 11)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444224)				--还没有属于您的奖励，请努力！
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	elseif TalkIndex == 8 then
		if (curhour == 20 or curhour == 21) or (curhour == 22 and curmin < 30) then
			if role.GetRoleItemNum(RoleID, 4800165) < 1 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444215)			--您就别蒙我了!
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, -1)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				Mid_autumnRanking(RoleID, 1)
				role.RemoveFromRole(MapID, InstanceID, RoleID, 4800165, 1, 401)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 444220)			--提交成功
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444214)				--您已经错过了今天的提交时间。
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	elseif TalkIndex == 9 then
		if (curhour == 20 or curhour == 21) or (curhour == 22 and curmin < 30) then
			if role.GetRoleItemNum(RoleID, 4800165) < 5 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444215)			--您就别蒙我了!
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, -1)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				Mid_autumnRanking(RoleID, 5)
				role.RemoveFromRole(MapID, InstanceID, RoleID, 4800165, 5, 401)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 444220)			--提交成功
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444214)				--您已经错过了今天的提交时间。
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	elseif TalkIndex == 10 then
		if (curhour == 20 or curhour == 21) or (curhour == 22 and curmin < 30) then
			if role.GetRoleItemNum(RoleID, 4800165) < 10 then
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 20, 444215)			--您就别蒙我了!
				msg.AddMsgEvent(MsgID, 24, TargetID)
				msg.AddMsgEvent(MsgID, 21, -1)
				msg.AddMsgEvent(MsgID, 1, 100002)
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			else
				Mid_autumnRanking(RoleID, 10)
				role.RemoveFromRole(MapID, InstanceID, RoleID, 4800165, 10, 401)
				local MsgID = msg.BeginMsgEvent()
				msg.AddMsgEvent(MsgID, 26, 444220)			--提交成功
				msg.DispatchRoleMsgEvent(RoleID, MsgID)
			end
		else
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 20, 444214)				--您已经错过了今天的提交时间。
			msg.AddMsgEvent(MsgID, 24, TargetID)
			msg.AddMsgEvent(MsgID, 21, 11)
			msg.AddMsgEvent(MsgID, 1, 100002)
			msg.DispatchRoleMsgEvent(RoleID, MsgID)
		end
	end
end
aux.RegisterCreatureEvent(5600072, 7, "c5600072_On_Talk")

--排名，前三
function Mid_autumnRanking(RoleID, handNum)
	local CurTime = tonumber(os.date("%j"))
	local UpdateTime = role.GetRoleScriptData(RoleID, 1, RoleDataType["MidAutumnTimes"])
	if CurTime ~= UpdateTime then
		role.SetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"], 0)
		role.SetRoleScriptData(RoleID, 1, RoleDataType["MidAutumnTimes"], CurTime)
	end
	role.SetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"], role.GetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"]) + handNum)
	local total = role.GetRoleScriptData(RoleID, 1, RoleDataType["MidAutumn"])
	if total > act.GetActScriptData(44, 1, 0) then
		if total > act.GetActScriptData(44, 1, 2) then
			if RoleID == act.GetActScriptData(44, 1, 5) then
				act.SetActScriptData(44, 1, 2, total)
			elseif	RoleID == act.GetActScriptData(44, 1, 4) then
				act.SetActScriptData(44, 1, 1, act.GetActScriptData(44, 1, 2))
				act.SetActScriptData(44, 1, 4, act.GetActScriptData(44, 1, 5))
				act.SetActScriptData(44, 1, 2, total)
				act.SetActScriptData(44, 1, 5, RoleID)
			else
				act.SetActScriptData(44, 1, 0, act.GetActScriptData(44, 1, 1))
				act.SetActScriptData(44, 1, 3, act.GetActScriptData(44, 1, 4))
				act.SetActScriptData(44, 1, 1, act.GetActScriptData(44, 1, 2))
				act.SetActScriptData(44, 1, 4, act.GetActScriptData(44, 1, 5))
				act.SetActScriptData(44, 1, 2, total)
				act.SetActScriptData(44, 1, 5, RoleID)
			end
		elseif total > act.GetActScriptData(44, 1, 1) then
			if RoleID == act.GetActScriptData(44, 1, 4) then
				act.SetActScriptData(44, 1, 1, total)
			else
				act.SetActScriptData(44, 1, 0, act.GetActScriptData(44, 1, 1))
				act.SetActScriptData(44, 1, 3, act.GetActScriptData(44, 1, 4))
				act.SetActScriptData(44, 1, 1, total)
				act.SetActScriptData(44, 1, 4, RoleID)
			end
		else
			act.SetActScriptData(44, 1, 0, total)
			act.SetActScriptData(44, 1, 3, RoleID)
		end
	end
	act.SaveActScriptData(44)
end

--雕像
function c5600073_On_Talk(MapID, InstanceID, TargetID, TargetTypeID, RoleID, TalkIndex)
	if TalkIndex == -1 then
		local MsgID = msg.BeginMsgEvent()
		msg.AddMsgEvent(MsgID, 20, 444227)				--确定要激活雕像吗？
		msg.AddMsgEvent(MsgID, 24, TargetID)
		msg.AddMsgEvent(MsgID, 21, 4)
		msg.AddMsgEvent(MsgID, 1, 100001)			--“确定”
		msg.AddMsgEvent(MsgID, 21, 5)
		msg.AddMsgEvent(MsgID, 1, 100002)
		msg.DispatchRoleMsgEvent(RoleID, MsgID)
	elseif TalkIndex == 4 then
		local x, y, z = unit.GetPosition(MapID, InstanceID, TargetID)
		local index = math.floor(role.GetRoleLevel(MapID, InstanceID, RoleID)/5)
		local tetable = {}
		tetable[6] = 1095105
		tetable[7] = 1095106
		tetable[8] = 1095107
		tetable[9] = 1095108
		tetable[10] = 1095109
		tetable[11] = 1095110
		tetable[12] = 1095111
		tetable[13] = 1095112
		tetable[14] = 1095113
		tetable[15] = 1095114
		tetable[16] = 1095115
		tetable[17] = 1095116
		tetable[18] = 1095117
		tetable[19] = 1095118
		if index < 6 then
			index = 6
		elseif index > 19 then
			index = 19
		end
		if math.random(100) > 95 and curNum < 1 then
			local recId = map.MapCreateColCreature(MapID, InstanceID, 1095119, x, y, z)
			cre.SetCreatureScriptData(3373743400, 1, recId, 1, 0, cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 0))
			curNum = 1
			local MsgID = msg.BeginMsgEvent()
			msg.AddMsgEvent(MsgID, 102, 300055)	--女王刷新
			msg.AddMsgEvent(MsgID, 9, x)
			msg.AddMsgEvent(MsgID, 9, z)
			msg.DispatchMapMsgEvent(MsgID, 3373743400, 1)
		else
			local recId = map.MapCreateColCreature(MapID, InstanceID, tetable[index], x, y, z)
			cre.SetCreatureScriptData(3373743400, 1, recId, 1, 0, cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 0))
		end
		map.MapDeleteCreature(MapID, InstanceID, TargetID)
	end
end
aux.RegisterCreatureEvent(5600073, 7, "c5600073_On_Talk")

--树妖
function c1095105_On_Die(MapID, InstanceID, TargetID, TargetTypeID, RoleID)
	local index = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 0)
	if index ~= 0 then
		table.insert(curS58pos, index)
	end
end
aux.RegisterCreatureEvent(1095105, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095106, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095107, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095108, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095109, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095110, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095111, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095112, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095113, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095114, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095115, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095116, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095117, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095118, 4, "c1095105_On_Die")
aux.RegisterCreatureEvent(1095119, 4, "c1095105_On_Die")

function c1095105_On_Disappear(MapID, InstanceID, TargetID, TargetTypeID)
	local index = cre.GetCreatureScriptData(MapID, InstanceID, TargetID, 1, 0)
	if index ~= 0 then
		table.insert(curS58pos, index)
	end
end
aux.RegisterCreatureEvent(1095105, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095106, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095107, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095108, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095109, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095110, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095111, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095112, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095113, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095114, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095115, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095116, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095117, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095118, 13, "c1095105_On_Disappear")
aux.RegisterCreatureEvent(1095119, 13, "c1095105_On_Disappear")

--玩家在活动中掉线后上线
function s58_CanTakeOverWhenOnline(MapID, RoleID)
	return 3424073512, 610+math.random(5), 23094, 669+math.random(5)
end
aux.RegisterMapEvent("s58",  12, "s58_CanTakeOverWhenOnline")

--找到地图的出口和坐标
function s58_GetExporMapAndCoord(MapID, InstanceID, RoleID)
	return 1, 3424073512, 610+math.random(5), 23094, 669+math.random(5)
end

aux.RegisterMapEvent("s58",  13, "s58_GetExporMapAndCoord")

--找到最合适的副本实例
function s58GetOnePerfectMap(MapID, InstanceID, RoleID)
	return 1
end
aux.RegisterMapEvent("s58",  14, "s58GetOnePerfectMap")

--检测玩家是否能够进入活动场景
function s58_CanEnter(MapID, InstanceID, RoleID)
	return 1
end
aux.RegisterMapEvent("s58",  15, "s58_CanEnter")

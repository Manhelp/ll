sampler2D g_baseTex1 : register(s0);
sampler2D g_baseTex2 : register(s1);
sampler2D g_baseTex3 : register(s2);
sampler2D g_alphaMap : register(s3);

half4 main( float2 baseTex1	: TEXCOORD0,
		float2 baseTex2 : TEXCOORD1,
		float2 baseTex3 : TEXCOORD2,
		float2 alphaMap	: TEXCOORD3,
		float4 diffuse  : COLOR0		
		) : COLOR0
{
	half4 ret=1;
	
	half3 baseTexColor1=tex2D(g_baseTex1, baseTex1).rgb;
	half3 baseTexColor2=tex2D(g_baseTex2, baseTex2).rgb;
	half3 baseTexColor3=tex2D(g_baseTex3, baseTex3).rgb;
	half2 alpha=tex2D(g_alphaMap, alphaMap).rg;
	
	ret.rgb=baseTexColor1.rgb*(1-alpha.x)+baseTexColor2*alpha.x;	
	ret.rgb=ret.rgb*(1-alpha.y)+baseTexColor3*alpha.y;
	
	ret.rgb*=diffuse.rgb*2.0f;
	
	return ret;
}